; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: %riscv32_cheri_llc -verify-machineinstrs < %s | FileCheck %s
; RUN: %riscv64_cheri_llc -verify-machineinstrs < %s | FileCheck %s
; RUN: %riscv32_cheri_purecap_llc -verify-machineinstrs < %s | FileCheck %s
; RUN: %riscv64_cheri_purecap_llc -verify-machineinstrs < %s | FileCheck %s

define void @callee_cap_int(i8 addrspace(200)* %cap, i8 %int) nounwind {
; CHECK-LABEL: callee_cap_int:
; CHECK:       # %bb.0:
; CHECK-NEXT:    sb.cap a1, ca0
; CHECK-NEXT:    ret
  store i8 %int, i8 addrspace(200)* %cap
  ret void
}

define void @callee_int_cap(i8 %int, i8 addrspace(200)* %cap) nounwind {
; CHECK-LABEL: callee_int_cap:
; CHECK:       # %bb.0:
; CHECK-NEXT:    sb.cap a0, ca1
; CHECK-NEXT:    ret
  store i8 %int, i8 addrspace(200)* %cap
  ret void
}

define void @callee_cap_cap_int(i8 addrspace(200)* %dst, i8 addrspace(200)* %src, i32 signext %offset) nounwind {
; CHECK-LABEL: callee_cap_cap_int:
; CHECK:       # %bb.0:
; CHECK-NEXT:    cincoffset ca0, ca0, a2
; CHECK-NEXT:    cincoffset ca1, ca1, a2
; CHECK-NEXT:    lb.cap a1, ca1
; CHECK-NEXT:    sb.cap a1, ca0
; CHECK-NEXT:    ret
  %srcoff = getelementptr inbounds i8, i8 addrspace(200)* %src, i32 %offset
  %val = load i8, i8 addrspace(200)* %srcoff
  %dstoff = getelementptr inbounds i8, i8 addrspace(200)* %dst, i32 %offset
  store i8 %val, i8 addrspace(200)* %dstoff
  ret void
}
